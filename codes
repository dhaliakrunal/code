package com.example.jsonreader.service;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.http.*;
import org.springframework.stereotype.Service;
import org.springframework.web.client.RestTemplate;

@Service
public class JsonReaderService {

    private final RestTemplate restTemplate;

    @Value("${api.url}")
    private String apiUrl;

    @Value("${api.token}")
    private String token;

    public JsonReaderService(RestTemplate restTemplate) {
        this.restTemplate = restTemplate;
    }

    public void fetchDataFromApi() {
        try {
            HttpHeaders headers = new HttpHeaders();
            headers.set("Authorization", token);
            headers.setAccept(MediaType.parseMediaTypes("application/json"));

            HttpEntity<String> entity = new HttpEntity<>(headers);

            ResponseEntity<String> response = restTemplate.exchange(
                    apiUrl,
                    HttpMethod.GET,
                    entity,
                    String.class
            );

            System.out.println("==== API RESPONSE ====");
            System.out.println(response.getBody());

        } catch (Exception e) {
            System.out.println("Error during API call: " + e.getMessage());
            e.printStackTrace();
        }
    }
}





package com.example.jsonreader;

import com.example.jsonreader.config.JsonFileProperties;
import com.example.jsonreader.service.JsonReaderService;
import org.springframework.boot.CommandLineRunner;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.context.properties.EnableConfigurationProperties;

@SpringBootApplication
@EnableConfigurationProperties(JsonFileProperties.class)
public class JsonReaderApplication implements CommandLineRunner {

    private final JsonReaderService jsonReaderService;

    public JsonReaderApplication(JsonReaderService jsonReaderService) {
        this.jsonReaderService = jsonReaderService;
    }

    public static void main(String[] args) {
        SpringApplication.run(JsonReaderApplication.class, args);
    }

    @Override
    public void run(String... args) {
        jsonReaderService.fetchDataFromApi();
    }
}






package com.example.jsonreader.config;

import lombok.Getter;
import lombok.Setter;
import org.springframework.boot.context.properties.ConfigurationProperties;

@Getter
@Setter
@ConfigurationProperties(prefix = "json")
public class JsonFileProperties {
    private String entitiesPath;
    private String kycPath;
    private String outputPath;
}






<dependency>
    <groupId>org.apache.httpcomponents</groupId>
    <artifactId>httpclient</artifactId>
    <version>4.5.13</version>
</dependency>





package com.example.jsonreader.controller;

import com.example.jsonreader.service.JsonReaderService;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

@RestController
@RequestMapping("/api")
public class JsonReaderController {

    private final JsonReaderService jsonReaderService;

    public JsonReaderController(JsonReaderService jsonReaderService) {
        this.jsonReaderService = jsonReaderService;
    }

    @GetMapping("/fetch")
    public ResponseEntity<String> fetchData() {
        try {
            String response = jsonReaderService.fetchDataFromApi();
            return ResponseEntity.ok(response);
        } catch (Exception e) {
            return ResponseEntity
                    .status(500)
                    .body("Error occurred: " + e.getMessage());
        }
    }
}





package com.example.jsonreader.service;

import com.example.jsonreader.model.EntityWrapper;
import com.example.jsonreader.model.KycWrapper;
import com.fasterxml.jackson.core.type.TypeReference;
import com.fasterxml.jackson.databind.ObjectMapper;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.http.*;
import org.springframework.stereotype.Service;
import org.springframework.web.client.RestTemplate;

import java.util.List;

@Service
public class JsonReaderService {

    private final RestTemplate restTemplate;
    private final ObjectMapper objectMapper;

    @Value("${api.entities-url}")
    private String entitiesUrl;

    @Value("${api.kyc-url}")
    private String kycUrl;

    @Value("${api.token}")
    private String token;

    public JsonReaderService(RestTemplate restTemplate) {
        this.restTemplate = restTemplate;
        this.objectMapper = new ObjectMapper();
    }

    public List<EntityWrapper> fetchEntities() {
        try {
            String entityJson = fetchApiJson(entitiesUrl);
            return objectMapper.readValue(entityJson, new TypeReference<List<EntityWrapper>>() {});
        } catch (Exception e) {
            throw new RuntimeException("Failed to fetch Entities: " + e.getMessage());
        }
    }

    public List<KycWrapper> fetchKycDetails() {
        try {
            String kycJson = fetchApiJson(kycUrl);
            return objectMapper.readValue(kycJson, new TypeReference<List<KycWrapper>>() {});
        } catch (Exception e) {
            throw new RuntimeException("Failed to fetch KYC: " + e.getMessage());
        }
    }

    private String fetchApiJson(String url) {
        HttpHeaders headers = new HttpHeaders();
        headers.set("Authorization", token);
        headers.setAccept(MediaType.parseMediaTypes("application/json"));

        HttpEntity<String> entity = new HttpEntity<>(headers);
        ResponseEntity<String> response = restTemplate.exchange(url, HttpMethod.GET, entity, String.class);

        return response.getBody();
    }
}




public String fetchDataFromApi() {
    try {
        HttpHeaders headers = new HttpHeaders();
        headers.set("Authorization", token);
        headers.setAccept(MediaType.parseMediaTypes("application/json"));

        HttpEntity<String> entity = new HttpEntity<>(headers);

        ResponseEntity<String> response = restTemplate.exchange(
                apiUrl,
                HttpMethod.GET,
                entity,
                String.class
        );

        return response.getBody();
    } catch (Exception e) {
        e.printStackTrace();
        throw new RuntimeException("API fetch failed: " + e.getMessage());
    }
}






package com.example.jsonreader.controller;

import com.example.jsonreader.model.EntityWrapper;
import com.example.jsonreader.model.KycWrapper;
import com.example.jsonreader.service.JsonReaderService;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@RestController
@RequestMapping("/api")
public class JsonReaderController {

    private final JsonReaderService jsonReaderService;

    public JsonReaderController(JsonReaderService jsonReaderService) {
        this.jsonReaderService = jsonReaderService;
    }

    @GetMapping("/entities")
    public ResponseEntity<List<EntityWrapper>> getEntities() {
        return ResponseEntity.ok(jsonReaderService.fetchEntities());
    }

    @GetMapping("/kyc")
    public ResponseEntity<List<KycWrapper>> getKyc() {
        return ResponseEntity.ok(jsonReaderService.fetchKycDetails());
    }
}


